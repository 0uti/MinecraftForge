--- ../src-base/minecraft/net/minecraft/src/NetClientHandler.java
+++ ../src-work/minecraft/net/minecraft/src/NetClientHandler.java
@@ -20,6 +20,9 @@
 import net.minecraft.client.Minecraft;
 import org.lwjgl.input.Keyboard;
 
+import cpw.mods.fml.common.LoaderException;
+import cpw.mods.fml.common.network.FMLNetworkHandler;
+
 public class NetClientHandler extends NetHandler
 {
     private boolean field_72554_f = false;
@@ -116,6 +119,7 @@
 
     public void func_72513_a(Packet252SharedKey p_72513_1_)
     {
+        this.func_72552_c(FMLNetworkHandler.getFMLFakeLoginPacket());
         this.func_72552_c(new Packet205ClientCommand(0));
     }
 
@@ -1164,6 +1168,11 @@
 
     public void func_72501_a(Packet250CustomPayload p_72501_1_)
     {
+        FMLNetworkHandler.handlePacket250Packet(p_72501_1_, field_72555_g, this);
+    }
+
+    public void handleVanilla250Packet(Packet250CustomPayload p_72501_1_)
+    {
         if ("MC|TPack".equals(p_72501_1_.field_73630_a))
         {
             String[] var2 = (new String(p_72501_1_.field_73629_c)).split("\u0000");
@@ -1208,4 +1217,10 @@
     {
         return this.field_72555_g;
     }
+
+    @Override
+    public EntityPlayer getPlayer()
+    {
+        return field_72563_h.field_71439_g;
+    }
 }
